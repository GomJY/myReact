<!DOCTYPE html>
<html lang="ko">

<head>
  <meta charset="UTF-8">
  <script src="https://unpkg.com/babel-standalone@6/babel.min.js"></script>
  <script crossorigin src="https://unpkg.com/react@16/umd/react.development.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@16/umd/react-dom.development.js"></script>
  <title>구구단</title>
</head>

<body>

  <body>
    <div id="root"></div>

    <script type="text/babel">
      class GuGuDan extends React.Component {
        constructor(props) {
          super(props);
          this.state = {
            first: Math.ceil(Math.random() * 9),  
            second: Math.ceil(Math.random() * 9),
            value: '',
            result: '',  
          };
        }
        
        onSubmit = (e) => {
          e.preventDefault();
          if(parseInt(this.state.value) === this.state.first * this.state.second) {
            this.setState((prevState) => { 
              return {
                result: ` 이전 정답[${prevState.value}] 정답!`,
                first: Math.ceil(Math.random() * 9),  
                second: Math.ceil(Math.random() * 9),
                value: '',
              }
            });
            this.input.focus(); //input이 붙은 ref에 focus()
          } else {
            this.setState({
              result: '땡',
              value: '',
            });
          }
        };
        
        onChange = (e) => { 
          this.setState({value: e.target.value}) 
        };

        
        inputRef = (c) => { this.input = c;};
        input;

        render() {
          console.log('렌더링');
          // <input ref={(c) => { this.input = c;}}
          return (
            <div>
              <div>{this.state.first}곱하기 { this.state.second }는?</div>
              <form onSubmit={ this.onSubmit }>
                <input ref={ this.inputRef }  type="number" value={this.state.value} onChange={this.onChange}/>
                <button >입력!</button>
              </form>   
              <div>{this.state.result}</div>
            </div> 
          );
        }
      }
    </script>
    <script type="text/babel">
      ReactDOM.render(
        <React.Fragment>
          <GuGuDan/>
        </React.Fragment>
      ,document.querySelector("#root"));
    </script>

    <script>
      /** ref
       * 정답을 입력한 경우 INPUT에 focus를 주어 바로 정답을 입력해주고 싶을때
       * React가 DOM을 알아서 관리해 준다는 생각으로 데이터만 바꾼다는 느낌으로 사용하면 좋다.
       *
       * 
       * 1.<input ref={(c) => { this.input = c;}}
       *   -render에서 JSX에 맞는 값을 넣는다.
       * 2.this.input.focus();
       *   -focus를 하고 싶은 곳에서 사용하기
       *
       *  this.setState()를 할때마다 렌더링을 하기 때문에 최적화를 할때는 최적화를 하는 것이 좋다.
       *    -JSX안에 함수를 넣는 경우에 렌더링이 될때마다 함수를 만들기 때문에 최대한 빼는 것이 좋다.
       **/
    </script>
  </body>

</html>

